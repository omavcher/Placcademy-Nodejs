<%= layout("/layouts/boilerplate") %>

<style>
.referral-container{
    width: 100%;
    height: 22rem;
    background-color: #f78f66;
}
.referral-container-header{
    width: 100%;
    height: 15rem;
    display: flex;
    justify-content: space-around;
}
.referral-container-heading{
    width: 30%;
    height: 100%;
    margin-left: 0.5rem;
}

.referral-container-heading h1{
    font-size: 3rem;
    font-weight: bold;
}
#referral-container-header-svg-p{
    display: flex;
    align-items: center;
    justify-content: space-around;
    font-size: 1.2rem;
}
.referral-section{
    width: 100%;
    height: 5rem;
    display: flex;
}
.your-referral-code{
    width: 22rem;
    height: 100%;
    border-radius: 0.5rem;
    background-color: aliceblue;
    display: flex;
    justify-content: space-around;
    align-items: center;
    margin-left: 15rem;

}
#your-code-section{
    width: 55%;
    height: 100%;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
}
#your-code-section h1{
   font-size: 1.5rem;
   font-weight: 600;
}
#copy-sharebtn-refral button{
    border: 2px solid #C33C04;
    padding: 0.5rem 1rem 0.5rem 1rem;
    font-size: 1rem;
    border-radius: 0.7rem;
    color: black;
    cursor: pointer;
}
#copy-btn {
    background-color: #C33C04;
}

.referral-info{
    width: 100%;
    height: 30rem;
    display: flex;
}

.your-referrals-box{
    width: 30%;
    height:auto;
    display: flex;
    align-items: center;
    flex-direction: column;
    padding-bottom: 2rem;
}
.your-referrals-box h1{
    font-size: 2rem;
    font-weight: bold;
    margin-top: 2rem;
}
.your-referrals-detalis{
    width: 70%;
    height: 100%;
    background-color: #C33C04;
}

#your-referrals-user-box{
    width: 25rem;
    height: auto;
    background-color: white;
    border: 2px solid black;
    border-radius: 2rem;
    display: flex;
    flex-direction: column;
    align-items: center;
}
#referral-user{
    margin: 0.5rem 0 0.5rem;
    width: 90%; 
    height: 3rem;
    border: 1px solid #ccc;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 1rem;
}
#referral-user:hover{
    background-color: #ccc;
}
@media only screen
and (min-device-width : 320px)
and (max-device-width : 480px) {
    .referral-info{
flex-direction: column;
    }

    .referral-container-heading{
    width: 56%;
    }
    .referral-container-heading h1{
        width: 12rem;
   font-size: 2rem;
    }
    #wallet-svg{
        width: 10rem;
    }
    #referral-container-header-svg-p{
        width: 18rem;
        font-size: 0.9rem;
    }
    .referral-section {
     width: 91%;
     margin-left: auto;
     margin-right: auto;
    }
    #your-code-section{
        width: 45%;
    }
    .your-referral-code{
        justify-content: center;
        width: 20rem;
    margin-left: auto;
    margin-right: auto;
    }

}


</style>


<div class="referral-container">
    <div class="referral-container-header">
        <div class="referral-container-heading">
        <h1>Refer friends, win exciting rewards</h1>
        <div id="referral-container-header-svg-p">
        <img src="/src/models_pics/Employee getting Customer requirements.svg">
        <p>5.6K learners have earned â‚¹1M+ worth of rewards</p>
       </div></div>
       <img id="wallet-svg" src="/src//models_pics/Wallet.svg">
    </div>


    <div class="referral-section">
     
        <div class="your-referral-code">
            <div id="your-code-section">
                <p>Your referral code</p>
                <h1 id="referral-code"><%= user.referral %></h1>
            </div>
            <div id="copy-sharebtn-refral">
                <button id="copy-btn">COPY</button>
                <button id="share-btn">SHARE</button>
            </div>
        </div>
    </div>
</div>



<div class="referral-info">
    <div class="your-referrals-box">
        <h1>Your Referrals</h1>
        <div id="your-referrals-user-box">
            <% if(referredUsers.length === 0){ %>
                <div id="referral-user">
                    <h2>No Users Referred</h2>
                </div>
            <% } else { %>
                <% for(let referredUser of referredUsers){ %>
                    <div id="referral-user">
                        <h2><%= referredUser.username %></h2>
                    </div>
                <% } %>
            <% } %>
        </div>
    </div>

    
    <div class="your-referrals-detalis"></div>


</div>






<script>
    document.addEventListener("DOMContentLoaded", () => {
    const copyBtn = document.getElementById("copy-btn");
    const shareBtn = document.getElementById("share-btn");
    const referralCode = document.getElementById("referral-code").innerText;

    copyBtn.addEventListener("click", () => {
        navigator.clipboard.writeText(referralCode).then(() => {
            alert("Referral code copied to clipboard!");
        }).catch(err => {
            console.error("Failed to copy text: ", err);
        });
    });

    shareBtn.addEventListener("click", () => {
        if (navigator.share) {
            navigator.share({
                title: "Referral Code",
                text: `Use my referral code: ${referralCode}`,
            }).then(() => {
                console.log("Referral code shared successfully!");
            }).catch(err => {
                console.error("Failed to share: ", err);
            });
        } else {
        }
    });
});

</script>